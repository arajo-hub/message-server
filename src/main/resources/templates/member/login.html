<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<th:block th:include="inc/asset.html::asset" />

<body>
    <div class="container">
        <form method="post" action="/member/login">
            <div class="mb-3">
                <label for="nickname" class="form-label">닉네임</label>
                <input type="text" class="form-control" id="nickname" name="nickname">
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">비밀번호</label>
                <input type="password" class="form-control" id="password" name="password">
            </div>
            <button type="submit" class="btn btn-primary" id="loginBtn">로그인</button>
        </form>
    </div>

    <script>

        $(() => loginView.init());

        var loginView = {

        };

        loginView.init = function () {
            this.loginBtnClick();
        };

        loginView.loginBtnClick = function() {

            var that = this;

            $("#loginBtn").click(function(e) {

                e.preventDefault();

                var requestParam = JSON.stringify({
                    nickname: $("#nickname").val(),
                    password: $("#password").val()
                });

                $.ajax({
                    url 		: "/member/login",
                    type 		: "POST",
                    data 		: requestParam,
                    dataType 	: "JSON",
                    contentType: 'application/json',
                })
                .success(function() {
                    window.location = "/message/list";
                })
                .error(function(result) {
                    var response = result.responseJSON;
                    if (response.resultCode == "404") {
                        alert("존재하지 않는 사용자입니다.");
                    } else if (response.resultCode == "WRONG_PASSWORD") {
                        alert("잘못된 비밀번호입니다.");
                    } else {
                        alert("알 수 없는 오류가 발생했습니다.");
                    }
                })
            });
        };

    </script>

</body>
</html>